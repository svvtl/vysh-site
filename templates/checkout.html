{% extends "base.html" %}
{% block title %}Оформлення замовлення{% endblock %}
{% block content %}

<div class="checkout-page">

  <h1 class="checkout-title">Оформлення замовлення</h1>

  {% if cart_items %}
  <div class="checkout-layout">

    <!-- LEFT -->
    <form id="checkoutForm" class="checkout-left" method="post">

      <!-- STEP 1 -->
      <div class="checkout-step">
        <div class="step-header">
          <span class="step-number active">1</span>
          <h3>Контактні дані</h3>
        </div>

        <div class="form-group">
          <label>Імʼя</label>
          <input type="text" name="name" required>
        </div>

        <div class="form-group">
          <label>Телефон</label>
          <input type="tel" name="phone" required>
        </div>

        <div class="form-group">
          <label>Email</label>
          <input type="email" name="email">
        </div>
      </div>

      <!-- STEP 2 -->
      <div class="checkout-step">
        <div class="step-header">
          <span class="step-number">2</span>
          <h3>Доставка</h3>
        </div>

        <div class="form-group">
          <label>Адреса доставки</label>
          <textarea name="address" rows="3" required></textarea>
        </div>
      </div>

      <!-- STEP 3 -->
      <div class="checkout-step">
        <div class="step-header">
          <span class="step-number">3</span>
          <h3>Оплата</h3>
        </div>

        <div class="payment-actions">
          <button type="submit" class="mono-btn">
            plata by mono
          </button>

          <button type="button" id="monoInstallmentBtn" class="installment-btn">
            Покупка частинами
          </button>
        </div>

        <!-- PARTS -->
        <div id="partsSelectWrapper" class="parts-wrapper" style="display:none;">
          <div class="form-group">
            <label>Кількість платежів</label>
            <select name="parts_count" id="partsCountSelect" required>
              <option value="3">3 платежі</option>
              <option value="6">6 платежів</option>
              <option value="10">10 платежів</option>
            </select>
          </div>

          <button type="button" id="confirmPartsBtn" class="installment-btn">
            Підтвердити оплату
          </button>
        </div>

        <div id="installment-error" class="checkout-error" style="display:none;"></div>

      </div>
    </form>

    <!-- RIGHT -->
    <div class="checkout-right">
      <div class="order-summary">
        <h3>Ваше замовлення</h3>

        <div class="order-number">
          Номер замовлення: <strong>{{ store_order_id }}</strong>
        </div>

        {% for row in cart_items %}
        <div class="summary-item">
          <span>{{ row.item.name }} × {{ row.qty }}</span>
          <span>{{ row.total }} ₴</span>
        </div>
        {% endfor %}

        <div class="summary-total">
          <span>Разом</span>
          <span>{{ total }} ₴</span>
        </div>
      </div>
    </div>

  </div>
  {% else %}
    <p>Кошик порожній</p>
    <a href="/products">← До каталогу</a>
  {% endif %}
</div>

<!-- JS ТВОЙ — БЕЗ ЗМІН -->
{{ super() }}

{% endblock %}

